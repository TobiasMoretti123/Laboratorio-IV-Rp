import{a as C,b as ee,d as te,e as ne,f as j,h as ie,i as oe}from"./chunk-EK6C4VJS.js";import{a as K,d as X,f as Y,h as Z}from"./chunk-CIBFGSKC.js";import{a as Q,l as $,m as G,n as J}from"./chunk-RFWKMY3H.js";import"./chunk-WXI33M2S.js";import"./chunk-U7MGYEHI.js";import{g as q,i as S}from"./chunk-JZGRMYVI.js";import{Ac as L,Ec as H,Fb as F,Fc as V,Gb as s,Gc as W,Hb as g,Ib as B,Jb as D,Kb as T,Lb as R,Mb as U,Oa as c,Pa as u,Qb as h,Rb as A,Sb as x,Tb as N,ba as I,ca as p,cb as f,ga as O,gb as v,la as E,lb as r,ma as d,mb as o,ob as k,pb as P,ub as l,wb as m,zc as z}from"./chunk-YTVPJGYC.js";var _=class n{constructor(t){this.firestore=t}mensajes=null;nuevoMensaje="";IniciarChat(){let t=j(this.firestore,"messages"),e=oe(t,ie("fecha","asc"));this.mensajes=te(e)}EnviarMensaje(t,e){let i=j(this.firestore,"messages");ne(i,{usuario:t,mensaje:e,fecha:C.now()}).then(()=>console.log("Mensaje enviado correctamente")).catch(a=>console.error("Error al enviar el mensaje:",a))}static \u0275fac=function(e){return new(e||n)(O(ee))};static \u0275prov=I({token:n,factory:n.\u0275fac,providedIn:"root"})};function se(n,t){if(n&1&&(r(0,"div",12),s(1),o()),n&2){let e=m();c(),g(e.usuarioLogeado)}}function ce(n,t){if(n&1&&(k(0),r(1,"div",14)(2,"div",15),s(3),h(4,"date"),o(),r(5,"div",16),s(6),o()(),P()),n&2){let e=m().$implicit,i=m();c(3),B("Tu ",x(4,2,i.ConvertirFecha(e.fecha),"short"),""),c(3),g(e.mensaje)}}function me(n,t){if(n&1&&(r(0,"div",17)(1,"div",15),s(2),h(3,"date"),o(),r(4,"div",18),s(5),o()()),n&2){let e=m().$implicit,i=m();c(2),D("",e.usuario," ",x(3,3,i.ConvertirFecha(e.fecha),"short"),""),c(3),g(e.mensaje)}}function le(n,t){if(n&1&&(r(0,"div"),f(1,ce,7,5,"ng-container",13)(2,me,6,6,"ng-template",null,0,N),o()),n&2){let e=t.$implicit,i=F(3),a=m();c(),v("ngIf",e.usuario===a.usuarioLogeado)("ngIfElse",i)}}var b=class n{constructor(t,e,i,a){this.fireDataBaseService=t;this.fireAuthService=e;this.router=i;this.snackBar=a}mostrarUsuario=!1;mensajes=[];nuevoMensaje="";usuarioLogeado="";ngOnInit(){this.fireDataBaseService.IniciarChat(),this.fireDataBaseService.mensajes?.subscribe(t=>{this.mensajes=t}),this.fireAuthService.getUserEmail().subscribe(t=>{this.usuarioLogeado=t})}CerrarSession(){this.fireAuthService.logout(),this.AbrirSnackBar("Se a cerrado la sesion"),this.RuteoHome()}AbrirSnackBar(t){this.snackBar.open(t,"Cerrar",{duration:2e3})}EnviarMensaje(){this.nuevoMensaje.trim()!==""&&(this.fireDataBaseService.EnviarMensaje(this.usuarioLogeado,this.nuevoMensaje),this.nuevoMensaje="",console.log(this.nuevoMensaje))}Volver(){this.RuteoHome()}RuteoHome(){this.router.navigate(["/Home"])}ConvertirFecha(t){return t instanceof C?t.toDate():t}MostrarUsuario(){this.mostrarUsuario=!0}OcultarUsuario(){this.mostrarUsuario=!1}SobreMi(){this.router.navigate(["/QuienSoy"])}static \u0275fac=function(e){return new(e||n)(u(_),u(Q),u(q),u(J))};static \u0275cmp=E({type:n,selectors:[["app-chat"]],decls:19,vars:5,consts:[["otherUser",""],[1,"button-grid"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","warn",3,"click"],[1,"material-icons",3,"mouseover","mouseleave"],["class","tooltip",4,"ngIf"],[1,"contenedor"],[1,"chat-box"],[1,"messages"],[4,"ngFor","ngForOf"],[1,"input-area"],["matInput","","type","text","placeholder","Escribe un mensaje...",3,"ngModelChange","ngModel"],[1,"tooltip"],[4,"ngIf","ngIfElse"],[1,"sent-message"],[1,"metadata"],[1,"message-sent"],[1,"received-message"],[1,"message-received"]],template:function(e,i){e&1&&(r(0,"div",1)(1,"button",2),l("click",function(){return i.Volver()}),s(2,"Volver"),o(),r(3,"button",2),l("click",function(){return i.SobreMi()}),s(4,"Sobre M\xED"),o(),r(5,"button",3),l("click",function(){return i.CerrarSession()}),s(6,"Cerrar Sesi\xF3n"),o(),r(7,"i",4),l("mouseover",function(){return i.MostrarUsuario()})("mouseleave",function(){return i.OcultarUsuario()}),s(8,"account_circle"),o(),f(9,se,2,1,"div",5),o(),r(10,"div",6)(11,"div",7)(12,"div",8),f(13,le,4,2,"div",9),h(14,"async"),o()(),r(15,"div",10)(16,"input",11),U("ngModelChange",function(w){return R(i.nuevoMensaje,w)||(i.nuevoMensaje=w),w}),o(),r(17,"button",3),l("click",function(){return i.EnviarMensaje()}),s(18,"Enviar"),o()()()),e&2&&(c(9),v("ngIf",i.mostrarUsuario),c(4),v("ngForOf",A(14,3,i.fireDataBaseService.mensajes)),c(3),T("ngModel",i.nuevoMensaje))},dependencies:[z,L,$,K,X,Y,H,V],styles:[".button-grid[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;background-color:#ffffff80;padding:.1vw;display:flex;justify-content:flex-end}.button-grid[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:.5vw;padding:1vw 2vw;font-size:1vw;margin-top:.5vw;margin-bottom:.5vw}.content[_ngcontent-%COMP%]{padding-top:50px}.material-icons[_ngcontent-%COMP%]{margin-left:1vw;margin-top:.4vw;font-size:2.5vw}.tooltip[_ngcontent-%COMP%]{position:absolute;background-color:#fff;color:#000;padding:5px;border-radius:3px;z-index:9999;margin-top:3vw;font-size:1vw}.contenedor[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background-color:#ffffff80;padding:1vw;border-radius:1vw;text-align:center;margin-top:2vw}.chat-box[_ngcontent-%COMP%]{width:40vw;height:35vw;border:.5vw solid #000000;background-color:#fff;border-radius:2vw;overflow-y:auto}.metadata[_ngcontent-%COMP%]{color:#000;margin-top:1vw;font-size:1vw}.sent-message[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;margin-bottom:1vw;font-size:1vw;margin-right:1vw}.received-message[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;margin-bottom:1vw;font-size:1vw;margin-left:1vw}.message-sent[_ngcontent-%COMP%]{background-color:#dcf8c6;padding:.5vw 1vw;border-radius:1vw}.message-received[_ngcontent-%COMP%]{background-color:#eaeaea;padding:.5vw 1vw;border-radius:1vw}.input-area[_ngcontent-%COMP%]{padding:1vw 2vw;display:flex;align-items:center}.input-area[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:1vw 2vw;font-size:1vw}.input-area[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:1.5vw;margin-left:1vw;font-size:1vw}"]})};var ue=[{path:"",component:b}],M=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=d({type:n});static \u0275inj=p({imports:[S.forChild(ue),S]})};var re=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=d({type:n});static \u0275inj=p({imports:[W,M,G,Z]})};export{re as ChatModule};
