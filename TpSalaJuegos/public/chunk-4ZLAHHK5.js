import{a as h,b as Z,d as ee,e as te,f as O,h as ne,i as ie}from"./chunk-UWEB5CVP.js";import{a as J,d as K,f as X,h as Y}from"./chunk-KFUXB3OE.js";import{a as q,l as Q,m as $,n as G}from"./chunk-EPGJXKQY.js";import"./chunk-WXI33M2S.js";import"./chunk-WSSWXG6I.js";import{g as W,i as y}from"./chunk-W2GDRTPK.js";import{Cc as L,Dc as H,Ec as V,Fb as D,Gb as s,Hb as x,Jb as S,Kb as T,Lb as w,Mb as R,Oa as c,Pa as l,Pb as v,Qb as z,Rb as j,Sb as U,ba as E,ca as u,cb as f,ga as P,gb as g,la as k,lb as r,ma as d,mb as o,ob as F,pb as B,ub as p,wb as m,xc as A,yc as N}from"./chunk-NLIUBASE.js";var C=class n{constructor(t){this.firestore=t}mensajes=null;nuevoMensaje="";IniciarChat(){let t=O(this.firestore,"messages"),e=ie(t,ne("fecha","asc"));this.mensajes=ee(e)}EnviarMensaje(t,e){let i=O(this.firestore,"messages");te(i,{usuario:t,mensaje:e,fecha:h.now()}).then(()=>console.log("Mensaje enviado correctamente")).catch(a=>console.error("Error al enviar el mensaje:",a))}static \u0275fac=function(e){return new(e||n)(P(Z))};static \u0275prov=E({token:n,factory:n.\u0275fac,providedIn:"root"})};function ae(n,t){if(n&1&&(r(0,"div",12),s(1),o()),n&2){let e=m();c(),x(e.usuarioLogeado)}}function se(n,t){if(n&1&&(F(0),r(1,"div",14)(2,"div",15),s(3),v(4,"date"),o(),r(5,"div",16),s(6),o()(),B()),n&2){let e=m().$implicit,i=m();c(3),S("",e.usuario," ",j(4,3,i.ConvertirFecha(e.fecha),"short"),""),c(3),x(e.mensaje)}}function ce(n,t){if(n&1&&(r(0,"div",17)(1,"div",15),s(2),v(3,"date"),o(),r(4,"div",18),s(5),o()()),n&2){let e=m().$implicit,i=m();c(2),S("",e.usuario," ",j(3,3,i.ConvertirFecha(e.fecha),"short"),""),c(3),x(e.mensaje)}}function me(n,t){if(n&1&&(r(0,"div"),f(1,se,7,6,"ng-container",13)(2,ce,6,6,"ng-template",null,0,U),o()),n&2){let e=t.$implicit,i=D(3),a=m();c(),g("ngIf",e.usuario===a.usuarioLogeado)("ngIfElse",i)}}var _=class n{constructor(t,e,i,a){this.fireDataBaseService=t;this.fireAuthService=e;this.router=i;this.snackBar=a}mostrarUsuario=!1;mensajes=[];nuevoMensaje="";usuarioLogeado="";ngOnInit(){this.fireDataBaseService.IniciarChat(),this.fireDataBaseService.mensajes?.subscribe(t=>{this.mensajes=t}),this.fireAuthService.getUserEmail().subscribe(t=>{this.usuarioLogeado=t})}CerrarSession(){this.fireAuthService.logout(),this.AbrirSnackBar("Se a cerrado la sesion"),this.RuteoHome()}AbrirSnackBar(t){this.snackBar.open(t,"Cerrar",{duration:2e3})}EnviarMensaje(){this.nuevoMensaje.trim()!==""&&(this.fireDataBaseService.EnviarMensaje(this.usuarioLogeado,this.nuevoMensaje),this.nuevoMensaje="",console.log(this.nuevoMensaje))}Volver(){this.RuteoHome()}RuteoHome(){this.router.navigate(["/Home"])}ConvertirFecha(t){return t instanceof h?t.toDate():t}MostrarUsuario(){this.mostrarUsuario=!0}OcultarUsuario(){this.mostrarUsuario=!1}SobreMi(){this.router.navigate(["/QuienSoy"])}static \u0275fac=function(e){return new(e||n)(l(C),l(q),l(W),l(G))};static \u0275cmp=k({type:n,selectors:[["app-chat"]],decls:19,vars:5,consts:[["otherUser",""],[1,"button-grid"],["mat-raised-button","",3,"click"],["mat-raised-button","","color","warn",3,"click"],[1,"material-icons",3,"mouseover","mouseleave"],["class","tooltip",4,"ngIf"],[1,"contenedor"],[1,"chat-box"],[1,"messages"],[4,"ngFor","ngForOf"],[1,"input-area"],["matInput","","type","text","placeholder","Escribe un mensaje...",3,"ngModelChange","ngModel"],[1,"tooltip"],[4,"ngIf","ngIfElse"],[1,"sent-message"],[1,"metadata"],[1,"message-sent"],[1,"received-message"],[1,"message-received"]],template:function(e,i){e&1&&(r(0,"div",1)(1,"button",2),p("click",function(){return i.Volver()}),s(2,"Volver"),o(),r(3,"button",2),p("click",function(){return i.SobreMi()}),s(4,"Sobre M\xED"),o(),r(5,"button",3),p("click",function(){return i.CerrarSession()}),s(6,"Cerrar Sesi\xF3n"),o(),r(7,"i",4),p("mouseover",function(){return i.MostrarUsuario()})("mouseleave",function(){return i.OcultarUsuario()}),s(8,"account_circle"),o(),f(9,ae,2,1,"div",5),o(),r(10,"div",6)(11,"div",7)(12,"div",8),f(13,me,4,2,"div",9),v(14,"async"),o()(),r(15,"div",10)(16,"input",11),R("ngModelChange",function(M){return w(i.nuevoMensaje,M)||(i.nuevoMensaje=M),M}),o(),r(17,"button",3),p("click",function(){return i.EnviarMensaje()}),s(18,"Enviar"),o()()()),e&2&&(c(9),g("ngIf",i.mostrarUsuario),c(4),g("ngForOf",z(14,3,i.fireDataBaseService.mensajes)),c(3),T("ngModel",i.nuevoMensaje))},dependencies:[A,N,Q,J,K,X,L,H],styles:[".button-grid[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;background-color:#ffffff80;padding:10px;display:flex;justify-content:flex-end}.button-grid[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:10px;margin-bottom:10px;padding:20px 30px;font-size:20px}.content[_ngcontent-%COMP%]{padding-top:50px}.material-icons[_ngcontent-%COMP%]{margin-left:10px;margin-top:2px;font-size:40px}.contenedor[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background-color:#ffffff80;padding:20px;border-radius:10px;text-align:center;margin-top:30px}.chat-box[_ngcontent-%COMP%]{width:450px;height:650px;border:4px solid #000000;border-radius:20px;overflow-y:auto;margin-left:20px}.metadata[_ngcontent-%COMP%]{font-size:12px;color:#000;margin-top:4px;font-size:18px}.sent-message[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;margin-bottom:10px;font-size:20px;margin-right:20px}.received-message[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;margin-bottom:10px;font-size:20px;margin-left:20px}.message-sent[_ngcontent-%COMP%]{background-color:#dcf8c6;padding:8px 12px;border-radius:8px}.message-received[_ngcontent-%COMP%]{background-color:#eaeaea;padding:8px 12px;border-radius:8px}.input-area[_ngcontent-%COMP%]{padding:20px 30px;display:flex;align-items:center}.input-area[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;padding:20px 30px;font-size:20px}.input-area[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:30px;margin-left:10px;font-size:20px}.volver[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;margin-top:10px;margin-bottom:10px;padding:20px 30px;font-size:20px}.tooltip[_ngcontent-%COMP%]{position:absolute;background-color:#fff;color:#000;padding:5px;border-radius:3px;z-index:9999;margin-top:60px;font-size:20px}"]})};var pe=[{path:"",component:_}],b=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=d({type:n});static \u0275inj=u({imports:[y.forChild(pe),y]})};var oe=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=d({type:n});static \u0275inj=u({imports:[V,b,$,Y]})};export{oe as ChatModule};
